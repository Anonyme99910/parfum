import{b as j,u as E,r,g as P,h as U,c,o as m,d as e,j as q,e as p,v,k as f,x as B,l as u,F,m as L,t as i,w as S,y as b}from"./index-DyWVem4z.js";import{t as w,f as D}from"./numbers-BTmV-EI5.js";import{P as A}from"./plus-Y9XiTSYj.js";import{E as I}from"./eye-HKr-JkNb.js";import{P as Q}from"./pen-square-DlN6EZcP.js";import{T as R}from"./trash-2-C3f3TS-P.js";import"./createLucideIcon--34oW_Gd.js";const G={class:"space-y-6"},H={class:"flex justify-between items-center"},J={class:"card overflow-hidden"},K={class:"table"},O={class:"font-medium"},W={class:"font-mono"},X={class:"font-bold text-green-600"},Y={class:"flex items-center gap-2"},Z=["onClick"],ee=["onClick"],te=["onClick"],se={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},le={class:"bg-white rounded-xl p-6 w-full max-w-md"},oe={class:"text-2xl font-bold mb-6"},ae={class:"flex gap-3 justify-end mt-6"},ne={type:"submit",class:"btn btn-primary"},fe={__name:"Customers",setup(re){const a=j(),g=E(),y=r([]),d=r(""),h=r(!1),n=r(!1),x=r(null),o=r({name:"",phone:"",address:""}),V=P(()=>d.value?y.value.filter(s=>s.name.includes(d.value)||s.phone.includes(d.value)):y.value),M=s=>D(s),z=s=>{g.push(`/clients/${s}`)},_=async()=>{try{const s=await b.getCustomers({per_page:100});y.value=s.data.data||s.data}catch(s){a.error("فشل تحميل العملاء"),console.error(s)}},N=async()=>{try{n.value?(await b.updateCustomer(x.value,o.value),a.success("تم تحديث العميل بنجاح")):(await b.createCustomer(o.value),a.success("تم إضافة العميل بنجاح")),C(),_()}catch{a.error("حدث خطأ")}},T=s=>{o.value={...s},x.value=s.id,n.value=!0},$=async s=>{if(confirm("هل أنت متأكد من حذف هذا العميل؟"))try{await b.deleteCustomer(s),a.success("تم حذف العميل بنجاح"),_()}catch{a.error("فشل حذف العميل")}},C=()=>{h.value=!1,n.value=!1,x.value=null,o.value={name:"",phone:"",address:""}};return U(()=>{_()}),(s,t)=>(m(),c("div",G,[e("div",H,[p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>d.value=l),type:"text",placeholder:"البحث عن عميل...",class:"input w-80"},null,512),[[v,d.value]]),e("button",{onClick:t[1]||(t[1]=l=>h.value=!0),class:"btn btn-primary flex items-center gap-2"},[f(u(A),{size:20}),t[5]||(t[5]=B(" إضافة عميل ",-1))])]),e("div",J,[e("table",K,[t[6]||(t[6]=e("thead",null,[e("tr",null,[e("th",null,"الاسم"),e("th",null,"الهاتف"),e("th",null,"إجمالي المشتريات"),e("th",null,"عدد الطلبات"),e("th",null,"الإجراءات")])],-1)),e("tbody",null,[(m(!0),c(F,null,L(V.value,l=>(m(),c("tr",{key:l.id},[e("td",O,i(l.name),1),e("td",W,i(u(w)(l.phone)),1),e("td",X,i(M(l.total_purchases)),1),e("td",null,i(u(w)(l.total_orders)),1),e("td",null,[e("div",Y,[e("button",{onClick:k=>z(l.id),class:"text-gray-700 hover:text-gray-900"},[f(u(I),{size:18})],8,Z),e("button",{onClick:k=>T(l),class:"text-blue-600 hover:text-blue-800"},[f(u(Q),{size:18})],8,ee),e("button",{onClick:k=>$(l.id),class:"text-red-600 hover:text-red-800"},[f(u(R),{size:18})],8,te)])])]))),128))])])]),h.value||n.value?(m(),c("div",se,[e("div",le,[e("h3",oe,i(n.value?"تعديل عميل":"إضافة عميل جديد"),1),e("form",{onSubmit:S(N,["prevent"]),class:"space-y-4"},[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium mb-2"},"الاسم",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.name=l),type:"text",required:"",class:"input"},null,512),[[v,o.value.name]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium mb-2"},"الهاتف",-1)),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.phone=l),type:"tel",required:"",class:"input"},null,512),[[v,o.value.phone]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium mb-2"},"العنوان",-1)),p(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.address=l),rows:"3",class:"input"},null,512),[[v,o.value.address]])]),e("div",ae,[e("button",{type:"button",onClick:C,class:"btn btn-secondary"},"إلغاء"),e("button",ne,i(n.value?"تحديث":"إضافة"),1)])],32)])])):q("",!0)]))}};export{fe as default};
