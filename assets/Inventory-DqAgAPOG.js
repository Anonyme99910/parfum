import{b as Q,r as i,g as W,h as X,c as d,o as m,d as t,j as I,k as g,t as a,l as n,s as F,x as Y,F as A,m as L,w as V,e as u,z as P,v as r,y as b}from"./index-C7vrHgk0.js";import{t as y,f as N}from"./numbers-BTmV-EI5.js";import{P as Z}from"./package-5hnWq7on.js";import{A as h,D as tt}from"./dollar-sign-QzG1ZLO5.js";import{P as et}from"./plus-BliDzUBC.js";import{P as lt}from"./pen-square-BoWksMyq.js";import{c as st}from"./createLucideIcon-Cvb7CoZR.js";/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=st("SettingsIcon",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),at={class:"space-y-6"},nt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ut={class:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white"},it={class:"flex items-center justify-between"},rt={class:"text-3xl font-bold mt-2"},dt={class:"card bg-gradient-to-br from-yellow-500 to-yellow-600 text-white"},mt={class:"flex items-center justify-between"},vt={class:"text-3xl font-bold mt-2"},ct={class:"card bg-gradient-to-br from-green-500 to-green-600 text-white"},bt={class:"flex items-center justify-between"},pt={class:"text-2xl font-bold mt-2"},yt={class:"card"},xt={class:"flex items-center justify-between mb-4"},gt={class:"flex gap-2 w-full md:w-auto"},ft={class:"overflow-x-auto"},kt={class:"table"},wt={class:"font-medium"},_t={class:"text-xs text-gray-500"},qt={class:"font-bold text-green-600"},Vt={class:"flex items-center gap-2"},Pt=["onClick"],zt=["onClick"],Ct={class:"bg-white rounded-xl p-6 w-full max-w-md"},Ut={class:"text-2xl font-bold mb-6"},jt={class:"text-sm text-gray-500 mt-1"},St={class:"flex gap-3 justify-end mt-6"},Mt={class:"bg-white rounded-xl p-6 w-full max-w-2xl m-4 max-h-[90vh] overflow-y-auto"},Ft={class:"text-2xl font-bold mb-6"},At={class:"grid grid-cols-2 gap-4"},Lt=["value"],$t=["value"],Bt={class:"flex gap-3 justify-end mt-6"},It={type:"submit",class:"btn btn-primary"},Jt={__name:"Inventory",setup(Nt){const x=Q(),k=i([]),w=i([]),_=i({}),z=i([]),C=i([]),f=i("all"),v=i(null),q=i(!1),p=i(null),c=i({type:"in",quantity:0,notes:""}),o=i({name:"",name_ar:"",barcode:"",sku:"",category_id:"",brand_id:"",cost_price:0,selling_price:0,stock_quantity:0,min_stock_level:10,size:"",is_active:!0}),T=W(()=>f.value==="all"?k.value:w.value),U=async()=>{try{const s=await b.getProducts({per_page:1e3});k.value=s.data.data||s.data||[]}catch(s){console.error("Failed to load products:",s),k.value=[]}},j=async()=>{try{const s=await b.getLowStockProducts();w.value=s.data.data||s.data||[]}catch(s){console.error("Failed to load low stock products:",s),w.value=[]}},S=async()=>{try{const s=await b.getInventoryReport();_.value=s.data.summary}catch{x.error("فشل تحميل الإحصائيات")}},D=async()=>{try{const s=await b.getCategories();z.value=s.data.data||s.data||[]}catch(s){console.error("Failed to load categories:",s),z.value=[]}},E=async()=>{try{const s=await b.getBrands();C.value=s.data.data||s.data||[]}catch(s){console.error("Failed to load brands:",s),C.value=[]}},K=s=>{v.value=s,c.value={type:"in",quantity:0,notes:""}},R=()=>{p.value=null,o.value={name:"",name_ar:"",barcode:"",sku:"",category_id:"",brand_id:"",cost_price:0,selling_price:0,stock_quantity:0,min_stock_level:10,size:"",is_active:!0},q.value=!0},G=s=>{p.value=s,o.value={...s},q.value=!0},M=()=>{q.value=!1,p.value=null},H=async()=>{try{p.value?(await b.updateProduct(p.value.id,o.value),x.success("تم تحديث المنتج بنجاح")):(await b.createProduct(o.value),x.success("تم إضافة المنتج بنجاح")),M(),U(),j(),S()}catch{x.error("حدث خطأ أثناء الحفظ")}},J=async()=>{var s,e;try{await b.adjustStock(v.value.id,c.value),x.success("تم تعديل المخزون بنجاح"),v.value=null,U(),j(),S()}catch(l){x.error(((e=(s=l.response)==null?void 0:s.data)==null?void 0:e.error)||"فشل تعديل المخزون")}};return X(()=>{U(),j(),S(),D(),E()}),(s,e)=>(m(),d("div",at,[t("div",nt,[t("div",ut,[t("div",it,[t("div",null,[e[19]||(e[19]=t("p",{class:"text-blue-100 text-sm"},"إجمالي المنتجات",-1)),t("h3",rt,a(n(y)(_.value.total_products||0)),1)]),g(n(Z),{size:48,class:"text-blue-200"})])]),t("div",dt,[t("div",mt,[t("div",null,[e[20]||(e[20]=t("p",{class:"text-yellow-100 text-sm"},"منتجات منخفضة",-1)),t("h3",vt,a(n(y)(_.value.low_stock_count||0)),1)]),g(n(h),{size:48,class:"text-yellow-200"})])]),t("div",ct,[t("div",bt,[t("div",null,[e[21]||(e[21]=t("p",{class:"text-green-100 text-sm"},"قيمة المخزون",-1)),t("h3",pt,a(n(N)(_.value.total_value||0)),1)]),g(n(tt),{size:48,class:"text-green-200"})])])]),t("div",yt,[t("div",xt,[t("div",gt,[t("button",{onClick:e[0]||(e[0]=l=>f.value="all"),class:F(["flex-1 text-center px-3 py-2 text-sm md:text-base rounded-lg font-semibold transition-colors",f.value==="all"?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," جميع المنتجات ("+a(n(y)(k.value.length))+") ",3),t("button",{onClick:e[1]||(e[1]=l=>f.value="low"),class:F(["flex-1 text-center px-3 py-2 text-sm md:text-base rounded-lg font-semibold transition-colors",f.value==="low"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," منتجات منخفضة ("+a(n(y)(w.value.length))+") ",3)]),t("button",{onClick:R,class:"btn btn-primary flex items-center gap-2 whitespace-nowrap ml-2"},[g(n(et),{size:20}),e[22]||(e[22]=Y(" إضافة منتج ",-1))])]),t("div",ft,[t("table",kt,[e[23]||(e[23]=t("thead",null,[t("tr",null,[t("th",null,"المنتج"),t("th",null,"التصنيف"),t("th",null,"العلامة التجارية"),t("th",null,"السعر"),t("th",null,"الكمية الحالية"),t("th",null,"الحد الأدنى"),t("th",null,"الإجراءات")])],-1)),t("tbody",null,[(m(!0),d(A,null,L(T.value,l=>{var $,B;return m(),d("tr",{key:l.id},[t("td",null,[t("div",null,[t("p",wt,a(l.name_ar),1),t("p",_t,a(l.size),1)])]),t("td",null,a(($=l.category)==null?void 0:$.name_ar),1),t("td",null,a((B=l.brand)==null?void 0:B.name_ar),1),t("td",qt,a(n(N)(l.selling_price)),1),t("td",null,[t("span",{class:F(["badge",l.stock_quantity===0?"badge-danger":l.stock_quantity<=l.min_stock_level?"badge-warning":"badge-success"])},a(n(y)(l.stock_quantity))+" قطعة ",3)]),t("td",null,a(n(y)(l.min_stock_level))+" قطعة",1),t("td",null,[t("div",Vt,[t("button",{onClick:O=>K(l),class:"text-blue-600 hover:text-blue-800"},[g(n(lt),{size:18})],8,Pt),t("button",{onClick:O=>G(l),class:"text-green-600 hover:text-green-800"},[g(n(ot),{size:18})],8,zt)])])])}),128))])])])]),v.value?(m(),d("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e[6]||(e[6]=V(l=>v.value=null,["self"]))},[t("div",Ct,[t("h3",Ut,"تعديل مخزون: "+a(v.value.name_ar),1),t("form",{onSubmit:V(J,["prevent"]),class:"space-y-4"},[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium mb-2"},"نوع العملية",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>c.value.type=l),required:"",class:"input"},[...e[24]||(e[24]=[t("option",{value:"in"},"إضافة للمخزون",-1),t("option",{value:"out"},"خصم من المخزون",-1),t("option",{value:"adjustment"},"تعديل المخزون",-1)])],512),[[P,c.value.type]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium mb-2"},"الكمية",-1)),u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>c.value.quantity=l),type:"number",required:"",class:"input"},null,512),[[r,c.value.quantity,void 0,{number:!0}]]),t("p",jt," المخزون الحالي: "+a(n(y)(v.value.stock_quantity)),1)]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium mb-2"},"ملاحظات",-1)),u(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>c.value.notes=l),rows:"3",class:"input"},null,512),[[r,c.value.notes]])]),t("div",St,[t("button",{type:"button",onClick:e[5]||(e[5]=l=>v.value=null),class:"btn btn-secondary"},"إلغاء"),e[28]||(e[28]=t("button",{type:"submit",class:"btn btn-primary"},"تأكيد",-1))])],32)])])):I("",!0),q.value?(m(),d("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",onClick:V(M,["self"])},[t("div",Mt,[t("h3",Ft,a(p.value?"تعديل منتج":"إضافة منتج جديد"),1),t("form",{onSubmit:V(H,["prevent"]),class:"space-y-4"},[t("div",At,[t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium mb-2"},"الاسم بالعربية *",-1)),u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.name_ar=l),type:"text",required:"",class:"input"},null,512),[[r,o.value.name_ar]])]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium mb-2"},"الاسم بالإنجليزية *",-1)),u(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.name=l),type:"text",required:"",class:"input"},null,512),[[r,o.value.name]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium mb-2"},"الباركود *",-1)),u(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.barcode=l),type:"text",required:"",class:"input"},null,512),[[r,o.value.barcode]])]),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium mb-2"},"SKU *",-1)),u(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.sku=l),type:"text",required:"",class:"input"},null,512),[[r,o.value.sku]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium mb-2"},"التصنيف *",-1)),u(t("select",{"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.category_id=l),required:"",class:"input"},[e[33]||(e[33]=t("option",{value:""},"اختر التصنيف",-1)),(m(!0),d(A,null,L(z.value,l=>(m(),d("option",{key:l.id,value:l.id},a(l.name_ar),9,Lt))),128))],512),[[P,o.value.category_id]])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium mb-2"},"العلامة التجارية *",-1)),u(t("select",{"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.brand_id=l),required:"",class:"input"},[e[35]||(e[35]=t("option",{value:""},"اختر العلامة",-1)),(m(!0),d(A,null,L(C.value,l=>(m(),d("option",{key:l.id,value:l.id},a(l.name_ar),9,$t))),128))],512),[[P,o.value.brand_id]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium mb-2"},"سعر التكلفة *",-1)),u(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.cost_price=l),type:"number",step:"0.01",required:"",class:"input"},null,512),[[r,o.value.cost_price,void 0,{number:!0}]])]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium mb-2"},"سعر البيع *",-1)),u(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>o.value.selling_price=l),type:"number",step:"0.01",required:"",class:"input"},null,512),[[r,o.value.selling_price,void 0,{number:!0}]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium mb-2"},"الكمية *",-1)),u(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>o.value.stock_quantity=l),type:"number",required:"",class:"input"},null,512),[[r,o.value.stock_quantity,void 0,{number:!0}]])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium mb-2"},"الحد الأدنى *",-1)),u(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>o.value.min_stock_level=l),type:"number",required:"",class:"input"},null,512),[[r,o.value.min_stock_level,void 0,{number:!0}]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium mb-2"},"الحجم",-1)),u(t("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>o.value.size=l),type:"text",class:"input",placeholder:"100ml"},null,512),[[r,o.value.size]])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium mb-2"},"الحالة",-1)),u(t("select",{"onUpdate:modelValue":e[18]||(e[18]=l=>o.value.is_active=l),class:"input"},[...e[42]||(e[42]=[t("option",{value:!0},"نشط",-1),t("option",{value:!1},"غير نشط",-1)])],512),[[P,o.value.is_active]])])]),t("div",Bt,[t("button",{type:"button",onClick:M,class:"btn btn-secondary"},"إلغاء"),t("button",It,a(p.value?"تحديث":"إضافة"),1)])],32)])])):I("",!0)]))}};export{Jt as default};
