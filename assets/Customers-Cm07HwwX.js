import{b as j,u as E,r,g as L,h as P,c,o as m,d as e,j as U,e as v,v as p,k as f,x as q,l as u,F as B,m as F,t as i,w as I,y as b}from"./index-D1BkHD3w.js";import{t as w,f as S}from"./numbers-BTmV-EI5.js";import{P as D}from"./plus-D8hzR50O.js";import{c as A}from"./createLucideIcon-BYv6tx1F.js";import{P as Q}from"./pen-square-DENLsmoP.js";import{T as R}from"./trash-2-4cJzehvZ.js";/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=A("EyeIcon",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),G={class:"space-y-6"},H={class:"flex justify-between items-center"},J={class:"card overflow-hidden"},K={class:"table"},O={class:"font-medium"},W={class:"font-mono"},X={class:"font-bold text-green-600"},Y={class:"flex items-center gap-2"},ee=["onClick"],te=["onClick"],se=["onClick"],oe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},le={class:"bg-white rounded-xl p-6 w-full max-w-md"},ae={class:"text-2xl font-bold mb-6"},ne={class:"flex gap-3 justify-end mt-6"},re={type:"submit",class:"btn btn-primary"},fe={__name:"Customers",setup(ue){const a=j(),g=E(),y=r([]),d=r(""),h=r(!1),n=r(!1),x=r(null),l=r({name:"",phone:"",address:""}),V=L(()=>d.value?y.value.filter(s=>s.name.includes(d.value)||s.phone.includes(d.value)):y.value),z=s=>S(s),M=s=>{g.push(`/clients/${s}`)},_=async()=>{try{const s=await b.getCustomers({per_page:100});y.value=s.data.data||s.data}catch(s){a.error("فشل تحميل العملاء"),console.error(s)}},N=async()=>{try{n.value?(await b.updateCustomer(x.value,l.value),a.success("تم تحديث العميل بنجاح")):(await b.createCustomer(l.value),a.success("تم إضافة العميل بنجاح")),C(),_()}catch{a.error("حدث خطأ")}},T=s=>{l.value={...s},x.value=s.id,n.value=!0},$=async s=>{if(confirm("هل أنت متأكد من حذف هذا العميل؟"))try{await b.deleteCustomer(s),a.success("تم حذف العميل بنجاح"),_()}catch{a.error("فشل حذف العميل")}},C=()=>{h.value=!1,n.value=!1,x.value=null,l.value={name:"",phone:"",address:""}};return P(()=>{_()}),(s,t)=>(m(),c("div",G,[e("div",H,[v(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>d.value=o),type:"text",placeholder:"البحث عن عميل...",class:"input w-80"},null,512),[[p,d.value]]),e("button",{onClick:t[1]||(t[1]=o=>h.value=!0),class:"btn btn-primary flex items-center gap-2"},[f(u(D),{size:20}),t[5]||(t[5]=q(" إضافة عميل ",-1))])]),e("div",J,[e("table",K,[t[6]||(t[6]=e("thead",null,[e("tr",null,[e("th",null,"الاسم"),e("th",null,"الهاتف"),e("th",null,"إجمالي المشتريات"),e("th",null,"عدد الطلبات"),e("th",null,"الإجراءات")])],-1)),e("tbody",null,[(m(!0),c(B,null,F(V.value,o=>(m(),c("tr",{key:o.id},[e("td",O,i(o.name),1),e("td",W,i(u(w)(o.phone)),1),e("td",X,i(z(o.total_purchases)),1),e("td",null,i(u(w)(o.total_orders)),1),e("td",null,[e("div",Y,[e("button",{onClick:k=>M(o.id),class:"text-gray-700 hover:text-gray-900"},[f(u(Z),{size:18})],8,ee),e("button",{onClick:k=>T(o),class:"text-blue-600 hover:text-blue-800"},[f(u(Q),{size:18})],8,te),e("button",{onClick:k=>$(o.id),class:"text-red-600 hover:text-red-800"},[f(u(R),{size:18})],8,se)])])]))),128))])])]),h.value||n.value?(m(),c("div",oe,[e("div",le,[e("h3",ae,i(n.value?"تعديل عميل":"إضافة عميل جديد"),1),e("form",{onSubmit:I(N,["prevent"]),class:"space-y-4"},[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium mb-2"},"الاسم",-1)),v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.name=o),type:"text",required:"",class:"input"},null,512),[[p,l.value.name]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium mb-2"},"الهاتف",-1)),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.phone=o),type:"tel",required:"",class:"input"},null,512),[[p,l.value.phone]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium mb-2"},"العنوان",-1)),v(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.address=o),rows:"3",class:"input"},null,512),[[p,l.value.address]])]),e("div",ne,[e("button",{type:"button",onClick:C,class:"btn btn-secondary"},"إلغاء"),e("button",re,i(n.value?"تحديث":"إضافة"),1)])],32)])])):U("",!0)]))}};export{fe as default};
